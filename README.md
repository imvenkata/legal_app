# Legal AI Assistant

A full-stack application using AI for legal document upload, analysis, research, contract generation, and vector-based semantic search with RAG capabilities.

## Features

-   **Document Management:** Securely upload and manage legal documents (PDF, DOCX, TXT).
-   **AI Analysis:** Leverage LLMs for document summarization, key point extraction, etc. (Original Feature)
-   **Vector Search:** Index documents into a vector database (Qdrant) for efficient semantic search.
-   **Retrieval-Augmented Generation (RAG):** Ask questions about your documents and receive answers generated by an LLM (e.g., OpenAI GPT) based on relevant retrieved context, complete with source citations.
-   **Contract Generation:** AI-assisted contract drafting and management. (Original Feature)
-   **User Authentication:** Secure user login and registration using JWT. (Original Feature)
-   **Modern UI:** Responsive user interface built with React and Material UI.

## Tech Stack

### Backend Services
1. **Main Backend (`backend/`)**
   - FastAPI (Python web framework)
   - MongoDB (Database)
   - JWT Authentication
   - OpenAI/Google AI integration

2. **Search Service (`legal_search_service/`)**
   - FastAPI
   - Qdrant (Vector Database)
   - Sentence Transformers (text embeddings)
   - LlamaParse (document parsing)
   - OpenAI/DeepSeek (RAG answer generation)

### Frontend (`frontend/`)
- React
- Material-UI
- Redux Toolkit
- Axios
- React Router
- React Dropzone

## Prerequisites

-   **Python:** 3.8+ (as per original README)
-   **Node.js:** 14+ (as per original README)
-   **npm:** (comes with Node.js)
-   **Docker:** Required for running Qdrant locally.
-   **uv:** Python package installer (see installation below).
-   **Git:** For cloning the repository.
-   **API Keys:**
    -   **OpenAI API Key:** Required for the RAG search functionality in `legal_search_service`.
    -   **DeepSeek API Key:** Required if `LLM_PROVIDER` is set to `deepseek`.
    -   *Potentially* Google AI API Key / other keys if used by the main `backend` service.
    -   *Optional* LlamaParse API Key for advanced document parsing features.
-   **MongoDB:** Needs to be running if used by the main `backend` service.

## Quick Start

1. Clone the repository:
```bash
git clone https://github.com/imvenkata/legal_app.git
cd legal_app
```

2. Set up environment variables:
```bash
# Copy environment files
cp legal_search_service/.env.example legal_search_service/.env
cp frontend/.env.example frontend/.env
```

3. Edit the environment files with your API keys and configuration.

4. Run the application using the provided script:
```bash
chmod +x run_local.sh
./run_local.sh
```

## Detailed Setup

### 1. Backend Setup

#### Main Backend Service
```bash
# Create and activate virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install dependencies
pip install -r backend/requirements.txt

# Start the server
cd backend
uvicorn app:app --reload --port 8000
```

#### Search Service
```bash
# Create and activate virtual environment
python -m venv venv_search
source venv_search/bin/activate  # On Windows: venv_search\Scripts\activate

# Install dependencies
pip install -r legal_search_service/requirements.txt

# Start the server
cd legal_search_service
uvicorn api.main:app --reload --port 8001
```

### 2. Frontend Setup
```bash
cd frontend
npm install
npm start
```

### 3. Vector Database (Qdrant)
```bash
# Start Qdrant using Docker
docker run -p 6333:6333 -p 6334:6334 \
       -v "$(pwd)/qdrant_data:/qdrant/storage" \
       qdrant/qdrant
```

## Configuration

### Search Service (.env)
```env
# Qdrant Configuration
QDRANT_URL=http://localhost:6333
QDRANT_API_KEY=
COLLECTION_NAME=legal_documents

# Embedding Model
EMBEDDING_MODEL_NAME=all-MiniLM-L6-v2

# LlamaParse (Optional)
LLAMA_CLOUD_API_KEY=

# OpenAI LLM
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL_NAME=gpt-4

# DeepSeek LLM
DEEPSEEK_API_KEY=your_deepseek_api_key_here
DEEPSEEK_MODEL_NAME=deepseek-chat
DEEPSEEK_BASE_URL=https://api.deepseek.com/v1

# LLM Selection
LLM_PROVIDER=deepseek  # Options: "openai", "deepseek"

# Data Path
DATA_PATH=./data
```

### Frontend (.env)
```env
REACT_APP_SEARCH_API_URL=http://localhost:8001/api/v1
REACT_APP_API_URL=http://localhost:8000
```

## Service Endpoints

### Main Backend (Port 8000)
- Health Check: `GET /health`
- Authentication: `POST /auth/login`
- Documents: `GET /documents`
- Research: `POST /research/search`
- Contracts: `GET /contracts/templates`

### Search Service (Port 8001)
- Health Check: `GET /api/v1/health`
- Document Upload: `POST /api/v1/documents/upload`
- Search: `POST /api/v1/search`
- Documents: `GET /api/v1/documents`

### Qdrant (Port 6333)
- REST API: `http://localhost:6333`
- Web UI: `http://localhost:6333/dashboard`
- gRPC API: `localhost:6334`

## Development

### Running Tests
```bash
# Backend tests
cd backend
pytest

# Search service tests
cd legal_search_service
pytest
```

### Code Style
- Backend: Follow PEP 8
- Frontend: ESLint configuration provided

## Troubleshooting

1. **Qdrant Connection Issues**
   - Ensure Docker is running
   - Check if ports 6333 and 6334 are available
   - Verify volume mount permissions

2. **API Key Issues**
   - Verify API keys in .env files
   - Check API key permissions
   - Ensure correct environment variables are loaded

3. **Frontend-Backend Connection**
   - Verify API URLs in frontend/.env
   - Check CORS settings in backend
   - Ensure all services are running

## Contributing

1. Fork the repository
2. Create a feature branch
3. Commit your changes
4. Push to the branch
5. Create a Pull Request

## License

[Your License Here] 